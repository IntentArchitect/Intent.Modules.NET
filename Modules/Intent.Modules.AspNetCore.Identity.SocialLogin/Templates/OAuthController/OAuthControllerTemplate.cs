// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 16.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Intent.Modules.AspNetCore.Identity.SocialLogin.Templates.OAuthController
{
    using System.Collections.Generic;
    using System.Linq;
    using Intent.Modules.Common;
    using Intent.Modules.Common.Templates;
    using Intent.Modules.Common.CSharp.Templates;
    using Intent.Templates;
    using Intent.Metadata.Models;
    using System;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "16.0.0.0")]
    public partial class OAuthControllerTemplate : CSharpTemplateBase<object>
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            this.Write("using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Security.Claims;\nusing System.Text;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing Microsoft.AspNetCore.Authorization;\nusing Microsoft.AspNetCore.Identity;\nusing Microsoft.AspNetCore.Mvc;\nusing Microsoft.AspNetCore.Mvc.ModelBinding;\nusing Microsoft.AspNetCore.WebUtilities;\nusing Microsoft.Extensions.Logging;\n\n[assembly: DefaultIntentManaged(Mode.Fully)]\n\nnamespace ");
            
            #line 26 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(Namespace));
            
            #line default
            #line hidden
            this.Write("\n{\n    [Route(\"api/oauth\")]\n    [ApiController]\n    public class ");
            
            #line 30 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write(" : ControllerBase\n    {\n\n        private readonly SignInManager<");
            
            #line 33 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(this.GetIdentityUserClass()));
            
            #line default
            #line hidden
            this.Write("> _signInManager;\n        private readonly ILogger<");
            
            #line 34 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write("> _logger;\n\n        public ");
            
            #line 36 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write("(\n            SignInManager<");
            
            #line 37 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(this.GetIdentityUserClass()));
            
            #line default
            #line hidden
            this.Write("> signInManager,\n            ILogger<");
            
            #line 38 "/home/shaine/projects/intent-architect/Intent.Modules.NET/Modules/Intent.Modules.AspNetCore.Identity.SocialLogin/Templates/OAuthController/OAuthControllerTemplate.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(ClassName));
            
            #line default
            #line hidden
            this.Write("> logger)\n        {\n            _signInManager = signInManager;\n            _logger = logger;\n        }\n\n        [HttpGet(\"providers\")]\n        [AllowAnonymous]\n        public async Task<ActionResult<List<string>>> Providers()\n        {\n            var providers = (await _signInManager.GetExternalAuthenticationSchemesAsync()).Select(x => x.Name).ToList();\n\n            return Ok(providers);\n        }\n\n        [HttpPost]\n        [AllowAnonymous]\n        public async Task<ChallengeResult> StartChallenge(string provider,\n            string? returnUrl /* even though this is not used here, it does actually end up in the callback */\n        )\n        {\n            var properties = _signInManager.ConfigureExternalAuthenticationProperties(provider, null);\n            properties.AllowRefresh = true;\n\n            return Challenge(properties, new[] { provider });\n        }\n\n        [HttpGet]\n        [AllowAnonymous]\n        public async Task<IActionResult> Callback(string? returnUrl, string? remoteError)\n        {\n            return Ok();\n        }\n\n    }\n}");
            return this.GenerationEnvironment.ToString();
        }
    }
    
}
